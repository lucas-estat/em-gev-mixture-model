# Parameter Estimation in GEV Mixture Models using the EM Algorithm

## Overview
This repository contains a **technical report developed as part of the Computational Statistics course** at the Institute of Mathematical and Computer Sciences (ICMC), University of São Paulo.

The project investigates **parameter estimation and estimator performance** in **finite mixture models of Generalized Extreme Value (GEV) distributions**, using the **Expectation–Maximization (EM) algorithm**. The work combines theoretical modeling, numerical optimization, Monte Carlo simulation, and real-data application.

AI tools were used as **support during development**, but all methodological decisions, analysis, and interpretation were critically reviewed and understood by the author.

---

## Motivation
Real-world datasets involving **extreme events** (e.g., hydrology, finance, energy consumption) are often **heterogeneous**, meaning they may arise from multiple latent regimes.  
Single-distribution models are frequently insufficient to capture this structure.

Finite mixture models address this issue by representing the data as a weighted combination of component distributions. The **GEV distribution** is particularly suitable in this context due to its theoretical role in extreme value theory and its flexibility in modeling different tail behaviors.

However, parameter estimation in mixture models is challenging due to:
- Non-convex likelihood functions
- Multiple local maxima
- Identifiability issues when components overlap

This project explores the use of the **EM algorithm** to address these challenges and evaluates its performance under controlled simulation settings.

---

## Objectives
The main objectives of this project are:

1. Implement the **EM algorithm** for parameter estimation in a **two-component GEV mixture model**
2. Evaluate estimator performance using a **Monte Carlo simulation study**, focusing on:
   - Bias
   - Mean Squared Error (MSE)
   - Convergence behavior
3. Demonstrate the **practical applicability** of the method using real-world data

---

## Methodology

### GEV Mixture Model
The data are modeled as a **finite mixture of two GEV distributions**, each with its own:
- Location parameter (μ)
- Scale parameter (σ)
- Shape parameter (γ)

A mixing weight determines the proportion of observations generated by each latent component.

---

### Expectation–Maximization (EM) Algorithm
Parameter estimation is performed using the EM algorithm, which alternates between:

- **E-step**:  
  Computes the posterior probability (responsibility) that each observation belongs to each mixture component.

- **M-step**:  
  Updates the mixture weights and GEV parameters by maximizing a weighted log-likelihood.  
  Numerical optimization (BFGS) is used due to the absence of closed-form solutions.

The algorithm iterates until convergence based on changes in the log-likelihood.

---

### Monte Carlo Simulation Study
To assess estimator quality, a simulation study was conducted with:
- 1000 Monte Carlo replications per scenario
- Fixed sample size (n = 100)
- Multiple parameter configurations with varying component overlap

Performance was evaluated using:
- Bias
- Mean Squared Error (MSE)
- Convergence rates

Only converged replications were included in the final analysis.

---

### Real Data Application
The methodology was applied to a real dataset on **petroleum consumption per capita**, which exhibits clear bimodality.

A **k-means-based initialization strategy** was used to improve convergence stability.  
The fitted GEV mixture model successfully captured the bimodal structure of the data, demonstrating the practical usefulness of the approach.

---

## Key Findings
- High convergence rates **do not guarantee accurate estimates**
- Certain scenarios exhibited low bias but high variance, especially for scale parameters
- Overlapping mixture components lead to identifiability issues and local maxima
- Initialization plays a critical role in EM performance
- k-means initialization significantly improves stability in real-data applications

---

## Repository Contents
- **`technical_report_em_gev_mixture.pdf`** The full technical report detailing the mathematical methodology, simulation results, and academic discussion.

- **`Source_Code_EM_GEV.Rmd`** The complete R-Markdown source code. This file is fully reproducible and contains all functions, simulation loops, and data visualization scripts.

- **`Source_Code_Output.pdf`** A "knitted" version of the source code. This document displays the code side-by-side with its outputs and plots, providing a quick way to review the implementation without running R.

---

## Limitations and Future Work
- Extension to mixtures with more than two components
- Comparison with Bayesian approaches (e.g., MCMC)
- Alternative optimization and initialization strategies
- Regression extensions with covariates affecting GEV parameters

---

## Author
**Lucas Alonso de Almeida**  
Institute of Mathematical and Computer Sciences (ICMC)  
University of São Paulo — São Carlos, Brazil

---

## Disclaimer
This repository contains an **academic course project**.  
It is intended for educational and demonstrative purposes.
